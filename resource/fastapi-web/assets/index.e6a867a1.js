import{d as S,P as U,r as h,o as v,f as k,w as t,g as a,j as f,k as b,I as Q,F as B,b1 as D,B as C,m as N,_ as q,q as I,s as E,ar as J,y as T,aP as K,aQ as O,a$ as G,b0 as H,a4 as F,aJ as W,i as X,ay as Y,h as Z,aL as x,aM as ee,aN as ae,b6 as te,b7 as le,b3 as oe,b8 as se}from"./index.9d2a6f93.js";import{u as A}from"./loading.2f897f78.js";/* empty css                */import{d as M,e as ne}from"./app.4b161933.js";/* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css              *//* empty css              *//* empty css               */import{q as pe}from"./model.d6c87741.js";/* empty css               */const ue=S({__name:"base-info",emits:["changeStep"],setup(y,{emit:_}){const{setLoading:d}=A(!1),s=U(),c=h(),r=h({id:"",name:"",remark:""});(async(n={id:s.query.id})=>{d(!0);try{const{data:p}=await M(n);r.value.id=p.id,r.value.name=p.name,r.value.remark=p.remark}catch{}finally{d(!1)}})();const e=async()=>{var p;await((p=c.value)==null?void 0:p.validate())||_("changeStep","forward",{...r.value})};return(n,p)=>{const w=Q,l=B,o=D,$=C,u=N;return v(),k(u,{ref_key:"formRef",ref:c,model:r.value,class:"form","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:t(()=>[a(l,{field:"name",label:n.$t("app.label.name"),rules:[{required:!0,message:n.$t("app.error.name.required")},{match:/^.{1,20}$/,message:n.$t("app.error.name.pattern")}]},{default:t(()=>[a(w,{modelValue:r.value.name,"onUpdate:modelValue":p[0]||(p[0]=m=>r.value.name=m),placeholder:n.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(l,{field:"remark",label:n.$t("app.label.remark"),rules:[{required:!1}]},{default:t(()=>[a(o,{modelValue:r.value.remark,"onUpdate:modelValue":p[1]||(p[1]=m=>r.value.remark=m),placeholder:n.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(l,null,{default:t(()=>[a($,{type:"primary",onClick:e},{default:t(()=>[f(b(n.$t("app.button.next")),1)]),_:1})]),_:1})]),_:1},8,["model"])}}});const re=q(ue,[["__scopeId","data-v-26c8744b"]]),ie=S({__name:"advanced",emits:["changeStep"],setup(y,{emit:_}){const{setLoading:d}=A(!0),s=U(),c=h([]);(async()=>{d(!0);try{const{data:l}=await pe();c.value=l.items}catch{}finally{d(!1)}})();const g=h(),e=h({models:[],is_limit_quota:!1,quota:h(),ip_whitelist:"",ip_blacklist:""});(async(l={id:s.query.id})=>{var o,$;d(!0);try{const{data:u}=await M(l);e.value.models=u.models,e.value.is_limit_quota=u.is_limit_quota,e.value.quota=u.quota,e.value.ip_whitelist=((o=u==null?void 0:u.ip_whitelist)==null?void 0:o.join(`
`))||"",e.value.ip_blacklist=(($=u==null?void 0:u.ip_blacklist)==null?void 0:$.join(`
`))||""}catch{}finally{d(!1)}})();const p=async()=>{var o;await((o=g.value)==null?void 0:o.validate())||_("changeStep","submit",{...e.value})},w=()=>{_("changeStep","backward")};return(l,o)=>{const $=K,u=O,m=B,V=G,j=H,L=D,R=C,z=F,P=N;return v(),k(P,{ref_key:"formRef",ref:g,model:e.value,class:"form","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:t(()=>[a(m,{field:"models",label:l.$t("app.label.models"),rules:[{required:!1}]},{default:t(()=>[a(u,{modelValue:e.value.models,"onUpdate:modelValue":o[0]||(o[0]=i=>e.value.models=i),placeholder:l.$t("app.placeholder.models"),"max-tag-count":3,multiple:"","allow-clear":""},{default:t(()=>[(v(!0),I(E,null,J(c.value,i=>(v(),k($,{key:i.id,value:i.id,label:i.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(m,{field:"is_limit_quota",label:l.$t("app.label.isLimitQuota")},{default:t(()=>[a(V,{modelValue:e.value.is_limit_quota,"onUpdate:modelValue":o[1]||(o[1]=i=>e.value.is_limit_quota=i)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_limit_quota?(v(),k(m,{key:0,field:"quota",label:l.$t("app.label.quota"),rules:[{required:!0,message:l.$t("app.error.quota.required")}]},{default:t(()=>[a(j,{modelValue:e.value.quota,"onUpdate:modelValue":o[2]||(o[2]=i=>e.value.quota=i),placeholder:l.$t("app.placeholder.quota"),min:1},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):T("",!0),a(m,{field:"ip_whitelist",label:l.$t("app.label.ip_whitelist"),rules:[{required:!1}]},{default:t(()=>[a(L,{modelValue:e.value.ip_whitelist,"onUpdate:modelValue":o[3]||(o[3]=i=>e.value.ip_whitelist=i),placeholder:l.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(m,{field:"ip_blacklist",label:l.$t("app.label.ip_blacklist"),rules:[{required:!1}]},{default:t(()=>[a(L,{modelValue:e.value.ip_blacklist,"onUpdate:modelValue":o[4]||(o[4]=i=>e.value.ip_blacklist=i),placeholder:l.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(m,null,{default:t(()=>[a(z,null,{default:t(()=>[a(R,{type:"secondary",onClick:w},{default:t(()=>[f(b(l.$t("model.button.prev")),1)]),_:1}),a(R,{type:"primary",onClick:p},{default:t(()=>[f(b(l.$t("model.button.next")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])}}});const de=q(ie,[["__scopeId","data-v-bc1c9ada"]]);const ce={},me={class:"success-wrap"};function _e(y,_){const d=W,s=C,c=F;return v(),I("div",me,[a(d,{status:"success",title:y.$t("app.success.title"),subtitle:y.$t("app.success.update.subTitle")},null,8,["title","subtitle"]),a(c,{size:16},{default:t(()=>[a(s,{key:"finish",type:"secondary",onClick:_[0]||(_[0]=r=>y.$router.push({name:"AppList"}))},{default:t(()=>[f(b(y.$t("app.button.return")),1)]),_:1}),a(s,{key:"again",type:"primary",onClick:_[1]||(_[1]=r=>y.$router.push({name:"AppDetail",query:{id:`${y.$route.query.id}`}}))},{default:t(()=>[f(b(y.$t("app.button.view")),1)]),_:1})]),_:1})])}const fe=q(ce,[["render",_e],["__scopeId","data-v-e283e987"]]),be={class:"container"},ve={class:"wrapper"},ye={name:"AppUpdate"},$e=S({...ye,setup(y){const{loading:_,setLoading:d}=A(!1),s=h(1),c=h({}),r=async()=>{d(!0);try{await ne(c.value),s.value=3,c.value={}}catch{}finally{d(!1)}},g=(e,n)=>{if(typeof e=="number"){s.value=e;return}if(e==="forward"||e==="submit"){if(c.value={...c.value,...n},e==="submit"){r();return}s.value+=1}else e==="backward"&&(s.value-=1)};return(e,n)=>{const p=x,w=ee,l=ae,o=te,$=le,u=oe,m=se;return v(),I("div",be,[a(l,{class:"container-breadcrumb"},{default:t(()=>[a(w,null,{default:t(()=>[a(p)]),_:1}),a(w,null,{default:t(()=>[f(b(e.$t("menu.app")),1)]),_:1}),a(w,null,{default:t(()=>[f(b(e.$t("menu.app.update")),1)]),_:1})]),_:1}),a(m,{loading:Z(_),style:{width:"100%"}},{default:t(()=>[a(u,{class:"general-card",bordered:!1},{title:t(()=>[f(b(e.$t("app.title.update")),1)]),default:t(()=>[X("div",ve,[a($,{current:s.value,"onUpdate:current":n[0]||(n[0]=V=>s.value=V),style:{width:"580px"},"line-less":"",class:"steps"},{default:t(()=>[a(o,{description:e.$t("app.subTitle.baseInfo")},{default:t(()=>[f(b(e.$t("app.title.baseInfo")),1)]),_:1},8,["description"]),a(o,{description:e.$t("app.subTitle.advanced")},{default:t(()=>[f(b(e.$t("app.title.advanced")),1)]),_:1},8,["description"]),a(o,{description:e.$t("app.subTitle.update.finish")},{default:t(()=>[f(b(e.$t("app.title.update.finish")),1)]),_:1},8,["description"])]),_:1},8,["current"]),(v(),k(Y,null,[s.value===1?(v(),k(re,{key:0,onChangeStep:g})):s.value===2?(v(),k(de,{key:1,onChangeStep:g})):s.value===3?(v(),k(fe,{key:2,onChangeStep:g})):T("",!0)],1024))])]),_:1})]),_:1},8,["loading"])])}}});const Be=q($e,[["__scopeId","data-v-c37fe2dc"]]);export{Be as default};
