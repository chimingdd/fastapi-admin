import{L as K,_ as M}from"./index.901bf666.js";/* empty css                *//* empty css                *//* empty css              *//* empty css                *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css                *//* empty css               */import{d as P,e as y,B as c,C as U,aH as o,aG as u,aL as r,aM as s,u as d,F as I,aD as v,aJ as R,aI as H,aE as _,bT as p,aK as Q,aF as W,b1 as X,b2 as Y,bA as Z,bB as x,bQ as ee,bi as le,b4 as ae,aT as te,aS as oe,bW as ue,bO as re,aU as se,b5 as de,bI as ie,bR as ne,g as pe}from"./arco.75032696.js";import{f as ce,h as me}from"./vue.ebfaaf45.js";import{u as fe}from"./loading.96e1cbd7.js";import{q as ve,c as be,d as ye}from"./notice.3aef045c.js";import{q as _e}from"./admin_user.a25d1213.js";import{q as Ve}from"./admin_reseller.f16aef9a.js";import{A as $e}from"./aieditor.5f1d4773.js";import"./chart.f8f3ffb1.js";/* empty css                */const ge={class:"container"},he={class:"wrapper"},we={class:"submit-btn"},ke={name:"NoticeUpdate"},Ue=P({...ke,setup(qe){const{proxy:q}=pe(),{loading:S,setLoading:m}=fe(!1),D=ce(),$=me(),F=y(),e=y({id:"",title:"",content:"",category:"",scope:y(),users:[],resellers:[],channels:[],is_popup:!1,priority:y(),expires_at:"",scheduled_time:"",remark:"",status:1}),C=y([]);(async()=>{m(!0);try{const{data:l}=await _e();C.value=l.items}catch{}finally{m(!1)}})();const B=y([]);(async()=>{m(!0);try{const{data:l}=await Ve();B.value=l.items}catch{}finally{m(!1)}})(),(async(l={id:$.query.id})=>{m(!0);try{const{data:a}=await ve(l);e.value.id=a.id,e.value.title=a.title,e.value.content=a.content,e.value.category=a.category,e.value.scope=String(a.scope),e.value.users=a.users,e.value.resellers=a.resellers,e.value.channels=a.channels,e.value.is_popup=a.is_popup,e.value.priority=a.priority,e.value.expires_at=a.expires_at,e.value.scheduled_time=a.scheduled_time,e.value.remark=a.remark,e.value.status=a.status}catch{}finally{m(!1)}})();const g=async l=>{var V;if(!await((V=F.value)==null?void 0:V.validate())){m(!0);try{e.value.status=l,$.query.action?await be(e.value).then(()=>{let i="\u64CD\u4F5C\u6210\u529F";l===1?i="\u53D1\u5E03\u6210\u529F":l===2&&(i="\u4FDD\u5B58\u6210\u529F"),q.$message.success(i),D.push({name:"NoticeList"})}):await ye(e.value).then(()=>{let i="\u66F4\u65B0\u6210\u529F";l===1?i="\u53D1\u5E03\u6210\u529F":l===2&&(i="\u4FDD\u5B58\u6210\u529F"),q.$message.success(i),D.push({name:"NoticeList"})})}catch{}finally{m(!1)}}};return(l,a)=>{const V=K,i=Q,E=W,T=X,n=Y,f=Z,h=x,b=ee,w=le,N=ae,A=te,z=oe,L=ue,O=re,k=se,j=de,G=ie,J=ne;return c(),U("div",ge,[o(E,{class:"container-breadcrumb"},{default:u(()=>[o(i,null,{default:u(()=>[o(V)]),_:1}),o(i,null,{default:u(()=>[r(s(l.$t("menu.notice")),1)]),_:1}),o(i,null,{default:u(()=>[r(s(l.$t(d($).query.action?"menu.notice.create":"menu.notice.update")),1)]),_:1})]),_:1}),o(J,{loading:d(S),style:{width:"100%"}},{default:u(()=>[o(G,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:u(()=>[I("div",he,[o(j,{ref_key:"formRef",ref:F,model:e.value,class:"form","label-col-props":{span:3},"wrapper-col-props":{span:18}},{default:u(()=>[o(n,{field:"title",label:l.$t("notice.label.title"),rules:[{required:!0,message:l.$t("notice.error.title.required")}]},{default:u(()=>[o(T,{modelValue:e.value.title,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.title=t),placeholder:l.$t("notice.placeholder.title"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(n,{field:"category",label:l.$t("notice.label.category"),rules:[{required:!0,message:l.$t("notice.error.category.required")}]},{default:u(()=>[o(h,{modelValue:e.value.category,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.category=t),placeholder:l.$t("notice.placeholder.category"),scrollbar:!1,"allow-search":""},{default:u(()=>[o(f,{value:"service"},{default:u(()=>[r(s(l.$t("notice.dict.category.service")),1)]),_:1}),o(f,{value:"activity"},{default:u(()=>[r(s(l.$t("notice.dict.category.activity")),1)]),_:1}),o(f,{value:"safety"},{default:u(()=>[r(s(l.$t("notice.dict.category.safety")),1)]),_:1}),o(f,{value:"maint"},{default:u(()=>[r(s(l.$t("notice.dict.category.maint")),1)]),_:1}),o(f,{value:"product"},{default:u(()=>[r(s(l.$t("notice.dict.category.product")),1)]),_:1}),o(f,{value:"fault"},{default:u(()=>[r(s(l.$t("notice.dict.category.fault")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(n,{field:"scope",label:l.$t("notice.label.scope"),rules:[{required:!0,message:l.$t("notice.error.scope.required")}]},{default:u(()=>[o(w,{size:"large"},{default:u(()=>[o(b,{modelValue:e.value.scope,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.scope=t),value:"1"},{default:u(()=>[r(s(l.$t("notice.dict.scope.1")),1)]),_:1},8,["modelValue"]),o(b,{modelValue:e.value.scope,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.scope=t),value:"2"},{default:u(()=>[r(s(l.$t("notice.dict.scope.2")),1)]),_:1},8,["modelValue"]),o(b,{modelValue:e.value.scope,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.scope=t),value:"3"},{default:u(()=>[r(s(l.$t("notice.dict.scope.3")),1)]),_:1},8,["modelValue"]),o(b,{modelValue:e.value.scope,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.scope=t),value:"4"},{default:u(()=>[r(s(l.$t("notice.dict.scope.4")),1)]),_:1},8,["modelValue"]),o(b,{modelValue:e.value.scope,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.scope=t),value:"5"},{default:u(()=>[r(s(l.$t("notice.dict.scope.5")),1)]),_:1},8,["modelValue"]),o(b,{modelValue:e.value.scope,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.scope=t),value:"6"},{default:u(()=>[r(s(l.$t("notice.dict.scope.6")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label","rules"]),e.value.scope==="4"||e.value.scope==="6"?(c(),v(n,{key:0,field:"users",label:l.$t("notice.label.users"),rules:[{required:!0,message:l.$t("notice.error.users.required")}]},{default:u(()=>[o(h,{modelValue:e.value.users,"onUpdate:modelValue":a[8]||(a[8]=t=>e.value.users=t),placeholder:l.$t("notice.placeholder.users"),scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:u(()=>[(c(!0),U(R,null,H(C.value,t=>(c(),v(f,{key:t.user_id,value:t.user_id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):_("",!0),e.value.scope==="5"||e.value.scope==="6"?(c(),v(n,{key:1,field:"resellers",label:l.$t("notice.label.resellers"),rules:[{required:!0,message:l.$t("notice.error.resellers.required")}]},{default:u(()=>[o(h,{modelValue:e.value.resellers,"onUpdate:modelValue":a[9]||(a[9]=t=>e.value.resellers=t),placeholder:l.$t("notice.placeholder.resellers"),scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:u(()=>[(c(!0),U(R,null,H(B.value,t=>(c(),v(f,{key:t.user_id,value:t.user_id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):_("",!0),o(n,{field:"channels",label:l.$t("notice.label.channels"),rules:[{required:!0,message:l.$t("notice.error.channels.required")}]},{default:u(()=>[o(w,{size:"large"},{default:u(()=>[o(N,{modelValue:e.value.channels,"onUpdate:modelValue":a[10]||(a[10]=t=>e.value.channels=t),value:"web","default-checked":!0},{default:u(()=>[r(s(l.$t("notice.dict.channels.web")),1)]),_:1},8,["modelValue"]),o(N,{modelValue:e.value.channels,"onUpdate:modelValue":a[11]||(a[11]=t=>e.value.channels=t),value:"email"},{default:u(()=>[r(s(l.$t("notice.dict.channels.email")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label","rules"]),e.value.channels.includes("web")?(c(),v(n,{key:2,field:"is_popup",label:l.$t("notice.label.is_popup")},{default:u(()=>[o(A,{modelValue:e.value.is_popup,"onUpdate:modelValue":a[12]||(a[12]=t=>e.value.is_popup=t)},null,8,["modelValue"])]),_:1},8,["label"])):_("",!0),o(n,{field:"priority",label:l.$t("notice.label.priority")},{default:u(()=>[o(z,{modelValue:e.value.priority,"onUpdate:modelValue":a[13]||(a[13]=t=>e.value.priority=t),placeholder:l.$t("notice.placeholder.priority"),precision:0,min:-999,max:99999},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(n,{field:"expires_at",label:l.$t("notice.label.expires_at")},{default:u(()=>[o(L,{modelValue:e.value.expires_at,"onUpdate:modelValue":a[14]||(a[14]=t=>e.value.expires_at=t),placeholder:l.$t("notice.placeholder.expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":t=>d(p)(t).isBefore(d(p)().subtract(1,"day")),style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>d(p)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(1,"day")},{label:"7",value:()=>d(p)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(7,"day")},{label:"15",value:()=>d(p)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(15,"day")},{label:"30",value:()=>d(p)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(30,"day")},{label:"90",value:()=>d(p)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(90,"day")},{label:"180",value:()=>d(p)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(180,"day")},{label:"365",value:()=>d(p)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"]),o(n,{field:"scheduled_time",label:l.$t("notice.label.scheduled_time")},{default:u(()=>[o(L,{modelValue:e.value.scheduled_time,"onUpdate:modelValue":a[15]||(a[15]=t=>e.value.scheduled_time=t),placeholder:l.$t("notice.placeholder.scheduled_time"),"disabled-date":t=>d(p)(t).isBefore(d(p)().subtract(1,"day")),style:{width:"100%"},"show-time":""},null,8,["modelValue","placeholder","disabled-date"])]),_:1},8,["label"]),o(n,{field:"content",label:l.$t("notice.label.content"),rules:[{required:!0,message:l.$t("notice.error.content.required")}]},{default:u(()=>[o($e,{modelValue:e.value.content,"onUpdate:modelValue":a[16]||(a[16]=t=>e.value.content=t),style:{flex:"1",height:"1024px"}},null,8,["modelValue"])]),_:1},8,["label","rules"]),o(n,{field:"remark",label:l.$t("notice.label.remark")},{default:u(()=>[o(O,{modelValue:e.value.remark,"onUpdate:modelValue":a[17]||(a[17]=t=>e.value.remark=t),placeholder:l.$t("notice.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(w,null,{default:u(()=>[I("div",we,[o(k,{type:"secondary",onClick:a[18]||(a[18]=t=>g(2))},{default:u(()=>[r(s(l.$t("button.draft")),1)]),_:1}),e.value.scheduled_time?_("",!0):(c(),v(k,{key:0,type:"primary",onClick:a[19]||(a[19]=t=>g(1))},{default:u(()=>[r(s(l.$t("button.publish")),1)]),_:1})),e.value.scheduled_time?(c(),v(k,{key:1,type:"primary",onClick:a[20]||(a[20]=t=>g(3))},{default:u(()=>[r(s(l.$t("button.scheduled")),1)]),_:1})):_("",!0)])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const xe=M(Ue,[["__scopeId","data-v-ded56600"]]);export{xe as default};
