import{u as ye,G as ke,p as xe,y as we,i as Ce,z as Ie,_ as ze}from"./index.cd29d4b2.js";/* empty css                *//* empty css                *//* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              */import{d as Se,r as H,e as s,c as R,w as Ve,B as l,C as i,aH as e,aG as o,aL as f,aM as c,aJ as V,aI as D,aD as q,F as _,u as j,D as De,n as $e,aK as Be,aF as Ee,b1 as Fe,b2 as Me,bC as Ne,bA as Le,bB as Ue,bD as Pe,b5 as Ae,bE as Ge,ab as Te,aU as He,bi as Re,bj as qe,bl as je,bm as Oe,b4 as Je,bF as Ke,bH as Qe,a_ as We,bI as Xe}from"./arco.75032696.js";import{u as Ye}from"./loading.96e1cbd7.js";import{b as Ze}from"./group.7a0d7f38.js";import{c as $,S as et}from"./sortable.esm.95f7b760.js";import{M as tt}from"./models.ecaaef61.js";import{q as at}from"./model.8f711567.js";import"./chart.f8f3ffb1.js";import"./vue.ebfaaf45.js";import"./corp.c87f1815.js";const ot={class:"container"},nt={class:"action-icon"},lt={class:"action-icon"},st={id:"tableSetting"},it={style:{"margin-right":"4px",cursor:"move"}},ct={class:"title"},rt={key:0,title:"\u9ED8\u8BA4\u5206\u7EC4"},ut={key:1},dt={key:0},mt={key:1},pt={key:0,class:"circle red"},_t={key:1,class:"circle"},gt={name:"MyGroup"},ft=Se({...gt,setup(vt){const{loading:O,setLoading:B}=Ye(!0),J=H({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),E=s([]);(async()=>{try{const{data:a}=await at();E.value=a.items}catch{}})();const K=()=>({name:"",models:[],model_agents:[],status:s(),remark:"",expires_at:[]}),{t:r}=ye(),F=s([]),u=s(K()),g=s([]),b=s([]),x=s("medium"),Q=s(),v={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},y=H({...v}),W=R(()=>[{name:r("size.mini"),value:"mini"},{name:r("size.small"),value:"small"},{name:r("size.medium"),value:"medium"},{name:r("size.large"),value:"large"}]),X=R(()=>[{title:r("group.columns.name"),dataIndex:"name",slotName:"name",align:"center",width:168},{title:r("group.columns.discount"),dataIndex:"discount",slotName:"discount",align:"center",width:128},{title:r("group.columns.models"),dataIndex:"model_names",slotName:"model_names",align:"center",width:128},{title:r("group.columns.expires_at"),dataIndex:"expires_at",slotName:"expires_at",align:"center",width:178},{title:r("group.columns.remark"),dataIndex:"remark",slotName:"remark",align:"center"},{title:r("group.columns.status"),dataIndex:"status",slotName:"status",align:"center",width:75}]),k=async(a={...v})=>{B(!0);try{const{data:n}=await Ze(a);F.value=n.items,y.current=a.current,y.pageSize=a.pageSize,y.total=n.paging.total}catch{}finally{B(!1)}},M=()=>{k({...v,...u.value})},Y=a=>{k({...v,...u.value,current:a})},Z=a=>{v.pageSize=a,k({...v,...u.value})};k();const ee=(a,n)=>{x.value=a},te=(a,n,d)=>{a?g.value.splice(d,0,n):g.value=b.value.filter(m=>m.dataIndex!==n.dataIndex)},N=(a,n,d,m=!1)=>{const p=m?$(a):a;return n>-1&&d>-1&&p.splice(n,1,p.splice(d,1,p[n]).pop()),p},ae=a=>{a&&$e(()=>{const n=document.getElementById("tableSetting");new et(n,{onEnd(d){const{oldIndex:m,newIndex:p}=d;N(g.value,m,p),N(b.value,m,p)}})})};Ve(()=>X.value,a=>{g.value=$(a),g.value.forEach((n,d)=>{n.checked=!0}),b.value=$(g.value)},{deep:!0,immediate:!0});const w=s(!1),L=s(),U=s(),oe=a=>{w.value=!0,L.value=a,U.value="group"};return(a,n)=>{const d=ke,m=Be,p=Ee,P=Fe,C=Me,h=Ne,ne=Le,le=Ue,I=Pe,se=Ae,A=Ge,ie=Te,G=He,ce=Re,re=xe,z=qe,ue=we,de=je,me=Oe,pe=Ce,_e=Ie,ge=Je,fe=Ke,ve=Qe,he=We,be=Xe;return l(),i("div",ot,[e(p,{class:"container-breadcrumb"},{default:o(()=>[e(m,null,{default:o(()=>[e(d)]),_:1}),e(m,null,{default:o(()=>[f(c(a.$t("menu.my.group")),1)]),_:1})]),_:1}),e(be,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:o(()=>[e(I,null,{default:o(()=>[e(h,{flex:1},{default:o(()=>[e(se,{model:u.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:o(()=>[e(I,{gutter:16},{default:o(()=>[e(h,{span:8},{default:o(()=>[e(C,{field:"name",label:a.$t("group.form.name")},{default:o(()=>[e(P,{modelValue:u.value.name,"onUpdate:modelValue":n[0]||(n[0]=t=>u.value.name=t),placeholder:a.$t("group.form.name.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(h,{span:8},{default:o(()=>[e(C,{field:"models",label:a.$t("group.form.models")},{default:o(()=>[e(le,{modelValue:u.value.models,"onUpdate:modelValue":n[1]||(n[1]=t=>u.value.models=t),placeholder:a.$t("group.form.selectDefault"),"max-tag-count":2,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:o(()=>[(l(!0),i(V,null,D(E.value,t=>(l(),q(ne,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(h,{span:8},{default:o(()=>[e(C,{field:"remark",label:a.$t("group.form.remark")},{default:o(()=>[e(P,{modelValue:u.value.remark,"onUpdate:modelValue":n[2]||(n[2]=t=>u.value.remark=t),placeholder:a.$t("group.form.remark.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(A,{style:{height:"42px"},direction:"vertical"}),e(h,{flex:"86px",style:{"text-align":"right"}},{default:o(()=>[e(ce,{direction:"vertical",size:18},{default:o(()=>[e(G,{type:"primary",onClick:M},{icon:o(()=>[e(ie)]),default:o(()=>[f(" "+c(a.$t("group.form.search")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(A,{style:{"margin-top":"0"}}),e(I,{style:{"margin-bottom":"16px"}},{default:o(()=>[e(h,{span:24,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:o(()=>[e(z,{content:a.$t("actions.refresh")},{default:o(()=>[_("div",{class:"action-icon",onClick:M},[e(re,{size:"18"})])]),_:1},8,["content"]),e(me,{onSelect:ee},{content:o(()=>[(l(!0),i(V,null,D(j(W),t=>(l(),q(de,{key:t.value,value:t.value,class:De({active:t.value===x.value})},{default:o(()=>[_("span",null,c(t.name),1)]),_:2},1032,["value","class"]))),128))]),default:o(()=>[e(z,{content:a.$t("actions.density")},{default:o(()=>[_("div",nt,[e(ue,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(z,{content:a.$t("actions.column_setting")},{default:o(()=>[e(fe,{trigger:"click",position:"bl",onPopupVisibleChange:ae},{content:o(()=>[_("div",st,[(l(!0),i(V,null,D(b.value,(t,T)=>(l(),i("div",{key:t.dataIndex,class:"setting"},[_("div",it,[e(_e)]),_("div",null,[e(ge,{modelValue:t.checked,"onUpdate:modelValue":S=>t.checked=S,onChange:S=>te(S,t,T)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_("div",ct,c(t.title==="#"?"\u5E8F\u5217\u53F7":t.title),1)]))),128))])]),default:o(()=>[_("div",lt,[e(pe,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(ve,{ref_key:"tableRef",ref:Q,"row-key":"id",loading:j(O),pagination:y,columns:g.value,data:F.value,bordered:!1,size:x.value,"row-selection":J,onPageChange:Y,onPageSizeChange:Z},{name:o(({record:t})=>[t.is_default?(l(),i("span",rt,[_("b",null,c(t.name),1)])):(l(),i("span",ut,c(t.name),1))]),discount:o(({record:t})=>[f(c(Number((t.discount*100).toFixed(2)))+"% ",1)]),model_names:o(({record:t})=>[t.model_names?(l(),i("span",dt,[e(G,{type:"text",size:"small",onClick:T=>oe(t.id)},{default:o(()=>[f(" \u67E5\u770B ")]),_:2},1032,["onClick"])])):(l(),i("span",mt,c("-")))]),expires_at:o(({record:t})=>[f(c(t.expires_at||"-"),1)]),remark:o(({record:t})=>[f(c(t.remark||"-"),1)]),status:o(({record:t})=>[t.status===2?(l(),i("span",pt)):(l(),i("span",_t)),f(" "+c(a.$t(`dict.status.${t.status}`)),1)]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),e(he,{visible:w.value,"onUpdate:visible":n[3]||(n[3]=t=>w.value=t),title:a.$t("common.models"),"modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"920px","ok-text":"\u5173\u95ED"},{default:o(()=>[e(tt,{id:L.value,action:U.value},null,8,["id","action"])]),_:1},8,["visible","title"])]),_:1})])}}});const jt=ze(ft,[["__scopeId","data-v-1a5e36c3"]]);export{jt as default};
