import{_ as S,z as G}from"./index.ca71b56b.js";/* empty css               *//* empty css                */import{d as I,e as w,B as c,aD as k,aG as t,aH as a,aL as y,aM as h,b1 as H,b2 as N,bK as T,aU as L,b5 as F,C as U,aJ as O,aI as Q,aE as A,u as v,bR as $,bA as W,bB as X,aT as Y,aS as Z,bS as x,bi as z,bz as ee,F as ae,bs as te,aK as le,aF as oe,bL as se,bM as ne,bJ as pe,bN as ue}from"./arco.eaecec6c.js";import{u as B}from"./loading.4b5db008.js";import{e as M,f as re}from"./app.eeeca0ef.js";/* empty css               *//* empty css               *//* empty css                */import{h as j}from"./vue.4ed7ee05.js";/* empty css                *//* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               */import{q as ie}from"./model.039d3b23.js";/* empty css                */import"./chart.54f38119.js";import"./base.87fcf6e2.js";const de=I({__name:"base-info",emits:["changeStep"],setup(b,{emit:f}){const{setLoading:m}=B(!1),u=j(),_=w(),i=w({id:"",name:"",remark:"",status:1});(async(r={id:u.query.id})=>{m(!0);try{const{data:s}=await M(r);i.value.id=s.id,i.value.name=s.name,i.value.remark=s.remark,i.value.status=s.status}catch{}finally{m(!1)}})();const e=async()=>{var s;await((s=_.value)==null?void 0:s.validate())||f("changeStep","forward",{...i.value})};return(r,s)=>{const V=H,l=N,o=T,q=L,n=F;return c(),k(n,{ref_key:"formRef",ref:_,model:i.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[a(l,{field:"name",label:r.$t("app.label.name"),rules:[{required:!0,message:r.$t("app.error.name.required")},{match:/^.{1,100}$/,message:r.$t("app.error.name.pattern")}]},{default:t(()=>[a(V,{modelValue:i.value.name,"onUpdate:modelValue":s[0]||(s[0]=d=>i.value.name=d),placeholder:r.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(l,{field:"remark",label:r.$t("app.label.remark"),rules:[{required:!1}]},{default:t(()=>[a(o,{modelValue:i.value.remark,"onUpdate:modelValue":s[1]||(s[1]=d=>i.value.remark=d),placeholder:r.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(l,null,{default:t(()=>[a(q,{type:"primary",onClick:e},{default:t(()=>[y(h(r.$t("app.button.next")),1)]),_:1})]),_:1})]),_:1},8,["model"])}}});const me=S(de,[["__scopeId","data-v-424bd0c4"]]),_e=I({__name:"advanced",emits:["changeStep"],setup(b,{emit:f}){const{setLoading:m}=B(!0),u=j(),_=w([]);(async()=>{m(!0);try{const{data:l}=await ie();_.value=l.items}catch{}finally{m(!1)}})();const g=w(),e=w({models:[],is_limit_quota:!1,quota:w(),quota_expires_at:"",ip_whitelist:"",ip_blacklist:""});(async(l={id:u.query.id})=>{var o,q;m(!0);try{const{data:n}=await M(l);e.value.models=n.models,e.value.is_limit_quota=n.is_limit_quota,e.value.quota=n.quota,e.value.quota_expires_at=n.quota_expires_at,e.value.ip_whitelist=((o=n==null?void 0:n.ip_whitelist)==null?void 0:o.join(`
`))||"",e.value.ip_blacklist=((q=n==null?void 0:n.ip_blacklist)==null?void 0:q.join(`
`))||""}catch{}finally{m(!1)}})();const s=async()=>{var o;await((o=g.value)==null?void 0:o.validate())||f("changeStep","submit",{...e.value})},V=()=>{f("changeStep","backward")};return(l,o)=>{const q=W,n=X,d=N,C=Y,K=Z,E=x,D=T,R=L,J=z,P=F;return c(),k(P,{ref_key:"formRef",ref:g,model:e.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[a(d,{field:"models",label:l.$t("app.label.models")},{default:t(()=>[a(n,{modelValue:e.value.models,"onUpdate:modelValue":o[0]||(o[0]=p=>e.value.models=p),placeholder:l.$t("app.placeholder.models"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:t(()=>[(c(!0),U(O,null,Q(_.value,p=>(c(),k(q,{key:p.id,value:p.id,label:p.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(d,{field:"is_limit_quota",label:l.$t("app.label.isLimitQuota")},{default:t(()=>[a(C,{modelValue:e.value.is_limit_quota,"onUpdate:modelValue":o[1]||(o[1]=p=>e.value.is_limit_quota=p)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_limit_quota?(c(),k(d,{key:0,field:"quota",label:l.$t("app.label.quota"),rules:[{required:!0,message:l.$t("app.error.quota.required")}]},{default:t(()=>[a(K,{modelValue:e.value.quota,"onUpdate:modelValue":o[2]||(o[2]=p=>e.value.quota=p),placeholder:l.$t("app.placeholder.quota"),precision:0,min:0,max:9999999999999},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):A("",!0),e.value.is_limit_quota?(c(),k(d,{key:1,field:"quota_expires_at",label:l.$t("app.label.quota_expires_at")},{default:t(()=>[a(E,{modelValue:e.value.quota_expires_at,"onUpdate:modelValue":o[3]||(o[3]=p=>e.value.quota_expires_at=p),placeholder:l.$t("app.placeholder.quota_expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":p=>v($)(p).isBefore(v($)()),style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>v($)().add(1,"day")},{label:"7",value:()=>v($)().add(7,"day")},{label:"15",value:()=>v($)().add(15,"day")},{label:"30",value:()=>v($)().add(30,"day")},{label:"90",value:()=>v($)().add(90,"day")},{label:"180",value:()=>v($)().add(180,"day")},{label:"365",value:()=>v($)().add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"])):A("",!0),a(d,{field:"ip_whitelist",label:l.$t("app.label.ip_whitelist")},{default:t(()=>[a(D,{modelValue:e.value.ip_whitelist,"onUpdate:modelValue":o[4]||(o[4]=p=>e.value.ip_whitelist=p),placeholder:l.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(d,{field:"ip_blacklist",label:l.$t("app.label.ip_blacklist")},{default:t(()=>[a(D,{modelValue:e.value.ip_blacklist,"onUpdate:modelValue":o[5]||(o[5]=p=>e.value.ip_blacklist=p),placeholder:l.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(d,null,{default:t(()=>[a(J,null,{default:t(()=>[a(R,{type:"secondary",onClick:V},{default:t(()=>[y(h(l.$t("model.button.prev")),1)]),_:1}),a(R,{type:"primary",onClick:s},{default:t(()=>[y(h(l.$t("model.button.next")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])}}});const ce=S(_e,[["__scopeId","data-v-44a5f010"]]);const fe={},be={class:"success-wrap"};function ve(b,f){const m=ee,u=L,_=z;return c(),U("div",be,[a(m,{status:"success",title:b.$t("app.success.title"),subtitle:b.$t("app.success.update.subTitle")},null,8,["title","subtitle"]),a(_,{size:16},{default:t(()=>[a(u,{key:"finish",type:"secondary",onClick:f[0]||(f[0]=i=>b.$router.push({name:"AppList"}))},{default:t(()=>[y(h(b.$t("app.button.return")),1)]),_:1}),a(u,{key:"again",type:"primary",onClick:f[1]||(f[1]=i=>b.$router.push({name:"AppDetail",query:{id:`${b.$route.query.id}`}}))},{default:t(()=>[y(h(b.$t("app.button.view")),1)]),_:1})]),_:1})])}const ye=S(fe,[["render",ve],["__scopeId","data-v-04d88f29"]]),he={class:"container"},$e={class:"wrapper"},ke={name:"AppUpdate"},qe=I({...ke,setup(b){const{loading:f,setLoading:m}=B(!1),u=w(1),_=w({}),i=async()=>{m(!0);try{await re(_.value),u.value=3,_.value={}}catch{}finally{m(!1)}},g=(e,r)=>{if(typeof e=="number"){u.value=e;return}if(e==="forward"||e==="submit"){if(_.value={..._.value,...r},e==="submit"){i();return}u.value+=1}else e==="backward"&&(u.value-=1)};return(e,r)=>{const s=G,V=le,l=oe,o=se,q=ne,n=pe,d=ue;return c(),U("div",he,[a(l,{class:"container-breadcrumb"},{default:t(()=>[a(V,null,{default:t(()=>[a(s)]),_:1}),a(V,null,{default:t(()=>[y(h(e.$t("menu.app")),1)]),_:1}),a(V,null,{default:t(()=>[y(h(e.$t("menu.app.update")),1)]),_:1})]),_:1}),a(d,{loading:v(f),style:{width:"100%"}},{default:t(()=>[a(n,{class:"general-card",bordered:!1},{default:t(()=>[ae("div",$e,[a(q,{current:u.value,"onUpdate:current":r[0]||(r[0]=C=>u.value=C),style:{width:"660px"},"line-less":"",class:"steps"},{default:t(()=>[a(o,{description:e.$t("app.subTitle.baseInfo")},{default:t(()=>[y(h(e.$t("app.title.baseInfo")),1)]),_:1},8,["description"]),a(o,{description:e.$t("app.subTitle.advanced")},{default:t(()=>[y(h(e.$t("app.title.advanced")),1)]),_:1},8,["description"]),a(o,{description:e.$t("app.subTitle.update.finish")},{default:t(()=>[y(h(e.$t("app.title.update.finish")),1)]),_:1},8,["description"])]),_:1},8,["current"]),(c(),k(te,null,[u.value===1?(c(),k(me,{key:0,onChangeStep:g})):u.value===2?(c(),k(ce,{key:1,onChangeStep:g})):u.value===3?(c(),k(ye,{key:2,onChangeStep:g})):A("",!0)],1024))])]),_:1})]),_:1},8,["loading"])])}}});const Pe=S(qe,[["__scopeId","data-v-55a5e2c0"]]);export{Pe as default};
