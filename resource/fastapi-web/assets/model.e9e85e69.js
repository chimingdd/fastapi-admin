import{u as Ve,B as Ie,m as ze,v as Se,I as De,w as Ae,_ as Le}from"./index.95d19ec3.js";import{u as Be}from"./loading.e3b9231d.js";/* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css                *//* empty css               *//* empty css               */import{c as N,S as Te}from"./sortable.esm.e23cfe8e.js";/* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css              */import{d as Fe,r as Q,e as _,c as S,w as qe,B as c,C as y,aH as t,aG as a,aL as i,aM as s,u as D,aJ as A,aI as L,aD as P,F as g,D as Ne,n as Pe,aK as Ke,aF as Me,bD as Ue,b3 as Ee,bB as Oe,b2 as Re,bC as je,bE as xe,bF as He,b6 as Ge,bG as Je,ab as Qe,aV as We,bj as Xe,a5 as Ye,bk as Ze,bm as et,bn as tt,b5 as at,bH as lt,bI as ot,bJ as nt,bK as st}from"./arco.a6f3e581.js";import{h as it}from"./vue.7b8f6a6a.js";import{s as ut,q as ct,a as rt}from"./key.9e86d229.js";import{q as dt}from"./model.cc15f1d7.js";import{e as mt}from"./agent.0a04dc1f.js";import"./chart.5d3761cb.js";const pt={class:"container"},_t={class:"action-icon"},ft={class:"action-icon"},yt={id:"tableSetting"},gt={style:{"margin-right":"4px",cursor:"move"}},vt={class:"title"},kt={key:0,class:"circle red"},bt={key:1,class:"circle"},ht={name:"KeyList"},$t=Fe({...ht,setup(wt){const K=it(),W=Q({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),M=_([]);(async()=>{try{const{data:e}=await dt();M.value=e.items}catch{}})();const U=_([]);(async()=>{try{const{data:e}=await mt();U.value=e.items}catch{}})();const X=async e=>{b(!0);try{await ut(e),I()}catch{}finally{b(!1)}},E=()=>({type:2,corp:"",key:"",models:[],model_agents:[],quota:_(),status:_(),created_at:[]}),{loading:Y,setLoading:b}=Be(!0),{t:u}=Ve(),O=_([]),n=_(E()),v=_([]),$=_([]),B=_("medium"),w={current:1,pageSize:10,showTotal:!0,showPageSize:!0},C=Q({...w}),Z=S(()=>[{name:u("searchTable.size.mini"),value:"mini"},{name:u("searchTable.size.small"),value:"small"},{name:u("searchTable.size.medium"),value:"medium"},{name:u("searchTable.size.large"),value:"large"}]),ee=S(()=>[{title:u("key.columns.corp"),dataIndex:"corp",slotName:"corp",align:"center",width:100},{title:u("key.columns.key"),dataIndex:"key",slotName:"key",align:"center",ellipsis:!0,tooltip:!0},{title:u("key.columns.models"),dataIndex:"model_names",slotName:"model_names",align:"center",ellipsis:!0,tooltip:!0},{title:u("key.columns.status"),dataIndex:"status",slotName:"status",align:"center",width:80},{title:u("key.columns.updated_at"),dataIndex:"updated_at",slotName:"updated_at",align:"center",width:170},{title:u("key.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:220}]),te=S(()=>[{label:u("key.dict.corp.OpenAI"),value:"OpenAI"}]),ae=S(()=>[{label:u("key.dict.status.1"),value:1},{label:u("key.dict.status.2"),value:2}]),R=new Array(0);K.query.agent_id&&(R[0]=K.query.agent_id);const V=async(e={current:1,pageSize:10,type:2,model_agents:R})=>{b(!0);try{const{data:o}=await ct(e);O.value=o.items,C.current=e.current,C.pageSize=e.pageSize,C.total=o.paging.total}catch{}finally{b(!1)}},I=()=>{V({...w,...n.value})},le=e=>{V({...w,...n.value,current:e})},oe=e=>{V({...w,...n.value,pageSize:e})};V();const ne=()=>{n.value=E()},se=async e=>{b(!0);try{e.status=e.status===1?2:1,await rt(e),I()}catch{}finally{b(!1)}},ie=(e,o)=>{B.value=e},ue=(e,o,m)=>{e?v.value.splice(m,0,o):v.value=$.value.filter(r=>r.dataIndex!==o.dataIndex)},j=(e,o,m,r=!1)=>{const p=r?N(e):e;return o>-1&&m>-1&&p.splice(o,1,p.splice(m,1,p[o]).pop()),p},ce=e=>{e&&Pe(()=>{const o=document.getElementById("tableSetting");new Te(o,{onEnd(m){const{oldIndex:r,newIndex:p}=m;j(v.value,r,p),j($.value,r,p)}})})};return qe(()=>ee.value,e=>{v.value=N(e),v.value.forEach((o,m)=>{o.checked=!0}),$.value=N(v.value)},{deep:!0,immediate:!0}),(e,o)=>{const m=Ie,r=Ke,p=Me,z=Ue,h=Ee,d=Oe,re=Re,x=je,de=xe,T=He,me=Ge,H=Je,pe=Qe,k=We,G=ze,J=Xe,_e=Ye,F=Ze,fe=Se,ye=et,ge=tt,ve=De,ke=Ae,be=at,he=lt,$e=ot,we=nt,Ce=st;return c(),y("div",pt,[t(p,{class:"container-breadcrumb"},{default:a(()=>[t(r,null,{default:a(()=>[t(m)]),_:1}),t(r,null,{default:a(()=>[i(s(e.$t("menu.key")),1)]),_:1}),t(r,null,{default:a(()=>[i(s(e.$t("menu.key.model.list")),1)]),_:1})]),_:1}),t(Ce,{class:"general-card",title:e.$t("menu.key.model.list"),bordered:!1},{default:a(()=>[t(T,null,{default:a(()=>[t(d,{flex:1},{default:a(()=>[t(me,{model:n.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[t(T,{gutter:16},{default:a(()=>[t(d,{span:8},{default:a(()=>[t(h,{field:"corp",label:e.$t("key.form.corp")},{default:a(()=>[t(z,{modelValue:n.value.corp,"onUpdate:modelValue":o[0]||(o[0]=l=>n.value.corp=l),options:D(te),placeholder:e.$t("key.form.selectDefault"),"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(d,{span:8},{default:a(()=>[t(h,{field:"key",label:e.$t("key.form.key")},{default:a(()=>[t(re,{modelValue:n.value.key,"onUpdate:modelValue":o[1]||(o[1]=l=>n.value.key=l),placeholder:e.$t("key.form.key.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(d,{span:8},{default:a(()=>[t(h,{field:"models",label:e.$t("key.form.models")},{default:a(()=>[t(z,{modelValue:n.value.models,"onUpdate:modelValue":o[2]||(o[2]=l=>n.value.models=l),placeholder:e.$t("key.form.selectDefault"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:a(()=>[(c(!0),y(A,null,L(M.value,l=>(c(),P(x,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(d,{span:8},{default:a(()=>[t(h,{field:"model_agents",label:e.$t("key.form.modelAgents")},{default:a(()=>[t(z,{modelValue:n.value.model_agents,"onUpdate:modelValue":o[3]||(o[3]=l=>n.value.model_agents=l),placeholder:e.$t("key.form.selectDefault"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:a(()=>[(c(!0),y(A,null,L(U.value,l=>(c(),P(x,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(d,{span:8},{default:a(()=>[t(h,{field:"status",label:e.$t("key.form.status")},{default:a(()=>[t(z,{modelValue:n.value.status,"onUpdate:modelValue":o[4]||(o[4]=l=>n.value.status=l),options:D(ae),placeholder:e.$t("key.form.selectDefault"),"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(d,{span:8},{default:a(()=>[t(h,{field:"created_at",label:e.$t("key.form.created_at")},{default:a(()=>[t(de,{modelValue:n.value.created_at,"onUpdate:modelValue":o[5]||(o[5]=l=>n.value.created_at=l),style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(H,{style:{height:"84px"},direction:"vertical"}),t(d,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[t(J,{direction:"vertical",size:18},{default:a(()=>[t(k,{type:"primary",onClick:I},{icon:a(()=>[t(pe)]),default:a(()=>[i(" "+s(e.$t("key.form.search")),1)]),_:1}),t(k,{onClick:ne},{icon:a(()=>[t(G)]),default:a(()=>[i(" "+s(e.$t("key.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(H,{style:{"margin-top":"0"}}),t(T,{style:{"margin-bottom":"16px"}},{default:a(()=>[t(d,{span:12},{default:a(()=>[t(J,null,{default:a(()=>[t(k,{type:"primary",onClick:o[6]||(o[6]=l=>e.$router.push({name:"KeyCreate"}))},{icon:a(()=>[t(_e)]),default:a(()=>[i(" "+s(e.$t("key.operation.create")),1)]),_:1})]),_:1})]),_:1}),t(d,{span:12,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:a(()=>[t(F,{content:e.$t("searchTable.actions.refresh")},{default:a(()=>[g("div",{class:"action-icon",onClick:I},[t(G,{size:"18"})])]),_:1},8,["content"]),t(ge,{onSelect:ie},{content:a(()=>[(c(!0),y(A,null,L(D(Z),l=>(c(),P(ye,{key:l.value,value:l.value,class:Ne({active:l.value===B.value})},{default:a(()=>[g("span",null,s(l.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[t(F,{content:e.$t("searchTable.actions.density")},{default:a(()=>[g("div",_t,[t(fe,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(F,{content:e.$t("searchTable.actions.columnSetting")},{default:a(()=>[t(he,{trigger:"click",position:"bl",onPopupVisibleChange:ce},{content:a(()=>[g("div",yt,[(c(!0),y(A,null,L($.value,(l,f)=>(c(),y("div",{key:l.dataIndex,class:"setting"},[g("div",gt,[t(ke)]),g("div",null,[t(be,{modelValue:l.checked,"onUpdate:modelValue":q=>l.checked=q,onChange:q=>ue(q,l,f)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),g("div",vt,s(l.title==="#"?"\u5E8F\u5217\u53F7":l.title),1)]))),128))])]),default:a(()=>[g("div",ft,[t(ve,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(we,{"row-key":"id",loading:D(Y),pagination:C,columns:v.value,data:O.value,bordered:!1,size:B.value,"row-selection":W,onPageChange:le,onPageSizeChange:oe},{type:a(({record:l})=>[i(s(e.$t(`key.dict.type.${l.type}`)),1)]),corp:a(({record:l})=>[i(s(e.$t(`key.dict.corp.${l.corp}`)),1)]),model_names:a(({record:l})=>{var f;return[i(s(((f=l==null?void 0:l.model_names)==null?void 0:f.join(","))||"-"),1)]}),dataFormat:a(({record:l})=>[i(s(e.$t(`key.dict.data_format.${l.data_format}`)),1)]),status:a(({record:l})=>[l.status===2?(c(),y("span",kt)):(c(),y("span",bt)),i(" "+s(e.$t(`key.dict.status.${l.status}`)),1)]),operations:a(({record:l})=>[t(k,{type:"text",size:"small",onClick:f=>e.$router.push({name:"KeyDetail",query:{id:`${l.id}`}})},{default:a(()=>[i(s(e.$t("key.columns.operations.view")),1)]),_:2},1032,["onClick"]),t(k,{type:"text",size:"small",onClick:f=>e.$router.push({name:"KeyUpdate",query:{id:`${l.id}`}})},{default:a(()=>[i(s(e.$t("key.columns.operations.update")),1)]),_:2},1032,["onClick"]),t(k,{type:"text",size:"small",onClick:f=>se({id:`${l.id}`,status:Number(`${l.status}`)})},{default:a(()=>[i(s(e.$t(`key.columns.operations.status.${l.status}`)),1)]),_:2},1032,["onClick"]),t($e,{content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?",onOk:f=>X({id:`${l.id}`})},{default:a(()=>[t(k,{type:"text",size:"small"},{default:a(()=>[i(s(e.$t("key.columns.operations.delete")),1)]),_:1})]),_:2},1032,["onOk"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"])]),_:1},8,["title"])])}}});const Jt=Le($t,[["__scopeId","data-v-41d4d1c5"]]);export{Jt as default};
