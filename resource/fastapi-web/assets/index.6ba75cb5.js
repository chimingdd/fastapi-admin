import{a as O,A as P,_ as W}from"./index.3cab79a5.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css              *//* empty css               *//* empty css               */import{d as x,e as n,bQ as X,B as m,C as B,aH as e,aG as l,aL as s,aM as c,F as q,bu as Y,aD as b,u as r,aJ as Z,aI as ee,E as ae,aE as h,bR as p,aW as le,aK as te,aF as oe,aS as ue,b2 as se,b1 as re,bA as de,bB as ie,aU as pe,aT as ne,bT as me,bU as _e,bV as ce,bM as be,bi as fe,b5 as ve,bI as ye,bN as $e,g as Ve}from"./arco.3652aec2.js";import{u as ke}from"./loading.83b7fc7f.js";import{f as qe}from"./vue.4b1b521c.js";import{q as he}from"./common.4fed7ae4.js";import{e as ge}from"./app.7aced790.js";import{q as we}from"./model.a9e0f114.js";import"./chart.f81658ef.js";import"./base.87fcf6e2.js";const Ce={class:"container"},Ae={class:"wrapper"},Be={class:"submit-btn"},Ue={name:"AppCreate"},Fe=x({...Ue,setup(Se){const{loading:U,setLoading:f}=ke(!1),{proxy:F}=Ve(),S=qe(),L=O(),y=n([]);(async()=>{f(!0);try{const{data:a}=await we();y.value=a.items}catch{}finally{f(!1)}})();const g=n(),t=n({user_id:n(),name:"",models:[],is_limit_quota:!1,quota:n(),quota_expires_at:"",ip_whitelist:"",ip_blacklist:"",is_create_key:!0,remark:""}),R=async()=>{var u;if(!await((u=g.value)==null?void 0:u.validate())){f(!0);try{const{data:_}=await ge(t.value);_.key?(navigator.clipboard.writeText(_.key),le.success("\u65B0\u5EFA\u6210\u529F, \u5BC6\u94A5\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")):F.$message.success("\u65B0\u5EFA\u6210\u529F"),S.push({name:"AppList"})}catch{}finally{f(!1)}}},D=a=>{t.value.quota=a*5e5},w=n(""),v=n(!1),I=()=>{v.value?t.value.models=[]:t.value.models=y.value.map(a=>a.id),v.value=!v.value,w.value=v.value?"blue":""};return(a,u)=>{const _=P,$=te,M=oe,C=ue,d=se,N=re,E=de,T=ie,V=pe,A=ne,i=me,Q=_e,z=ce,k=be,G=fe,j=ve,H=ye,J=$e,K=X("permission");return m(),B("div",Ce,[e(M,{class:"container-breadcrumb"},{default:l(()=>[e($,null,{default:l(()=>[e(_)]),_:1}),e($,null,{default:l(()=>[s(c(a.$t("menu.app")),1)]),_:1}),e($,null,{default:l(()=>[s(c(a.$t("menu.app.create")),1)]),_:1})]),_:1}),e(J,{loading:r(U),style:{width:"100%"}},{default:l(()=>[e(H,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:l(()=>[q("div",Ae,[e(j,{ref_key:"formRef",ref:g,model:t.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:l(()=>[Y((m(),b(d,{field:"user_id",label:a.$t("app.label.user_id"),rules:[{required:r(L).role==="admin",message:a.$t("app.error.user_id.required")}]},{default:l(()=>[e(C,{modelValue:t.value.user_id,"onUpdate:modelValue":u[0]||(u[0]=o=>t.value.user_id=o),placeholder:a.$t("app.placeholder.user_id"),min:1},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])),[[K,["admin"]]]),e(d,{field:"name",label:a.$t("app.label.name"),rules:[{required:!0,message:a.$t("app.error.name.required")},{match:/^.{1,100}$/,message:a.$t("app.error.name.pattern")}]},{default:l(()=>[e(N,{modelValue:t.value.name,"onUpdate:modelValue":u[1]||(u[1]=o=>t.value.name=o),placeholder:a.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(d,{field:"models",label:a.$t("app.label.models")},{default:l(()=>[e(T,{modelValue:t.value.models,"onUpdate:modelValue":u[2]||(u[2]=o=>t.value.models=o),placeholder:a.$t("app.placeholder.models"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:l(()=>[(m(!0),B(Z,null,ee(y.value,o=>(m(),b(E,{key:o.id,value:o.id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"]),e(V,{style:ae({backgroundColor:w.value}),onClick:I},{default:l(()=>[s("\u2705")]),_:1},8,["style"])]),_:1},8,["label"]),e(d,{field:"is_limit_quota",label:a.$t("app.label.isLimitQuota")},{default:l(()=>[e(A,{modelValue:t.value.is_limit_quota,"onUpdate:modelValue":u[3]||(u[3]=o=>t.value.is_limit_quota=o)},null,8,["modelValue"])]),_:1},8,["label"]),t.value.is_limit_quota?(m(),b(d,{key:0,field:"quota",label:a.$t("app.label.quota"),rules:[{required:!0,message:a.$t("app.error.quota.required")}]},{default:l(()=>[e(C,{modelValue:t.value.quota,"onUpdate:modelValue":u[4]||(u[4]=o=>t.value.quota=o),placeholder:a.$t("app.placeholder.quota"),precision:0,min:0,max:9999999999999,style:{width:"492px","margin-right":"10px"}},null,8,["modelValue","placeholder"]),q("div",null," $"+c(t.value.quota?r(he)(t.value.quota):"0"),1)]),_:1},8,["label","rules"])):h("",!0),t.value.is_limit_quota?(m(),b(d,{key:1},{default:l(()=>[e(Q,{type:"button",onChange:D},{default:l(()=>[e(i,{value:1},{default:l(()=>[s(" $1 ")]),_:1}),e(i,{value:5},{default:l(()=>[s(" $5 ")]),_:1}),e(i,{value:10},{default:l(()=>[s(" $10 ")]),_:1}),e(i,{value:20},{default:l(()=>[s(" $20 ")]),_:1}),e(i,{value:50},{default:l(()=>[s(" $50 ")]),_:1}),e(i,{value:100},{default:l(()=>[s(" $100 ")]),_:1}),e(i,{value:200},{default:l(()=>[s(" $200 ")]),_:1}),e(i,{value:500},{default:l(()=>[s(" $500 ")]),_:1}),e(i,{value:1e3},{default:l(()=>[s(" $1000 ")]),_:1})]),_:1},8,["onChange"])]),_:1})):h("",!0),t.value.is_limit_quota?(m(),b(d,{key:2,field:"quota_expires_at",label:a.$t("app.label.quota_expires_at")},{default:l(()=>[e(z,{modelValue:t.value.quota_expires_at,"onUpdate:modelValue":u[5]||(u[5]=o=>t.value.quota_expires_at=o),placeholder:a.$t("app.placeholder.quota_expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":o=>r(p)(o).isBefore(r(p)()),style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>r(p)().add(1,"day")},{label:"7",value:()=>r(p)().add(7,"day")},{label:"15",value:()=>r(p)().add(15,"day")},{label:"30",value:()=>r(p)().add(30,"day")},{label:"90",value:()=>r(p)().add(90,"day")},{label:"180",value:()=>r(p)().add(180,"day")},{label:"365",value:()=>r(p)().add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"])):h("",!0),e(d,{field:"ip_whitelist",label:a.$t("app.label.ip_whitelist")},{default:l(()=>[e(k,{modelValue:t.value.ip_whitelist,"onUpdate:modelValue":u[6]||(u[6]=o=>t.value.ip_whitelist=o),placeholder:a.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(d,{field:"ip_blacklist",label:a.$t("app.label.ip_blacklist")},{default:l(()=>[e(k,{modelValue:t.value.ip_blacklist,"onUpdate:modelValue":u[7]||(u[7]=o=>t.value.ip_blacklist=o),placeholder:a.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(d,{field:"is_create_key",label:a.$t("app.label.is_create_key")},{default:l(()=>[e(A,{modelValue:t.value.is_create_key,"onUpdate:modelValue":u[8]||(u[8]=o=>t.value.is_create_key=o)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{field:"remark",label:a.$t("app.label.remark"),rules:[{required:!1}]},{default:l(()=>[e(k,{modelValue:t.value.remark,"onUpdate:modelValue":u[9]||(u[9]=o=>t.value.remark=o),placeholder:a.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(G,null,{default:l(()=>[q("div",Be,[e(V,{type:"secondary",onClick:u[10]||(u[10]=o=>a.$router.push({name:"AppList"}))},{default:l(()=>[s(c(a.$t("button.cancel")),1)]),_:1}),e(V,{type:"primary",onClick:R},{default:l(()=>[s(c(a.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const ea=W(Fe,[["__scopeId","data-v-5a69f792"]]);export{ea as default};
