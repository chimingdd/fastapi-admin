import{u as Ue,B as ze,C as De,E as qe,F as Se,m as Be,v as Te,I as Fe,w as Ne,_ as Le}from"./index.313639ab.js";import{u as Me}from"./loading.156d38e2.js";/* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css                *//* empty css               *//* empty css               */import{c as T,S as Ee}from"./sortable.esm.a14b782c.js";/* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css              */import{d as Pe,r as j,e as r,c as F,w as xe,B as _,C as y,aH as e,aG as t,aL as m,aM as i,aJ as N,aI as L,aD as W,u as M,F as v,D as Oe,n as Ae,aV as Qe,aK as Re,aF as Ge,b3 as He,b4 as Je,bC as Ke,bD as je,bE as We,bF as Xe,bG as Ye,b7 as Ze,bH as ea,ab as aa,aW as ta,bk as la,a5 as oa,bl as sa,bn as na,bo as ua,b6 as ra,bI as ia,bJ as da,bK as ca,aT as ma,b0 as pa,bM as _a}from"./arco.4eee3931.js";import{q as fa}from"./model.0035c374.js";import"./chart.01f9d9eb.js";import"./vue.a3868d4c.js";const va={class:"container"},ba={class:"action-icon"},ha={class:"action-icon"},ga={id:"tableSetting"},ya={style:{"margin-right":"4px",cursor:"move"}},ka={class:"title"},$a={key:0,class:"circle"},wa={key:1,class:"circle pass"},Ca={name:"UserList"},Va=Pe({...Ca,setup(Ia){const X=j({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),E=r([]);(async()=>{try{const{data:a}=await fa();E.value=a.items}catch{}})();const Y=async a=>{f(!0);try{await ze(a),k()}catch{}finally{f(!1)}},P=()=>({user_id:r(),name:"",models:[],key:"",type:r(),status:r(),created_at:[]}),{loading:Z,setLoading:f}=Me(!0),{t:n}=Ue(),x=r([]),s=r(P()),b=r([]),V=r([]),I=r("medium"),U={current:1,pageSize:10,showTotal:!0},z=j({...U}),ee=F(()=>[{name:n("searchTable.size.mini"),value:"mini"},{name:n("searchTable.size.small"),value:"small"},{name:n("searchTable.size.medium"),value:"medium"},{name:n("searchTable.size.large"),value:"large"}]),ae=F(()=>[{title:n("user.columns.userId"),dataIndex:"user_id",slotName:"user_id"},{title:n("user.columns.name"),dataIndex:"name",slotName:"name"},{title:n("user.columns.email"),dataIndex:"email",slotName:"email"},{title:n("user.columns.quota"),dataIndex:"quota",slotName:"quota"},{title:n("user.columns.status"),dataIndex:"status",slotName:"status"},{title:n("user.columns.updated_at"),dataIndex:"updated_at",slotName:"updated_at"},{title:n("user.columns.operations"),dataIndex:"operations",slotName:"operations"}]),te=F(()=>[{label:n("user.dict.status.1"),value:1},{label:n("user.dict.status.2"),value:2}]),k=async(a={current:1,pageSize:10})=>{f(!0);try{const{data:o}=await De(a);x.value=o.items,z.current=a.current,z.total=o.paging.total}catch{}finally{f(!1)}},O=()=>{k({...U,...s.value})},le=a=>{k({...U,...s.value,current:a})};k();const oe=()=>{s.value=P()},se=(a,o)=>{I.value=a},ne=(a,o,u)=>{a?b.value.splice(u,0,o):b.value=V.value.filter(d=>d.dataIndex!==o.dataIndex)},A=(a,o,u,d=!1)=>{const p=d?T(a):a;return o>-1&&u>-1&&p.splice(o,1,p.splice(u,1,p[o]).pop()),p},ue=a=>{a&&Ae(()=>{const o=document.getElementById("tableSetting");new Ee(o,{onEnd(u){const{oldIndex:d,newIndex:p}=u;A(b.value,d,p),A(V.value,d,p)}})})};xe(()=>ae.value,a=>{b.value=T(a),b.value.forEach((o,u)=>{o.checked=!0}),V.value=T(b.value)},{deep:!0,immediate:!0});const $=r(!1),Q=r(),w=r({}),re=async a=>{f(!0);try{w.value.user_id=a.user_id,$.value=!0}catch{}finally{f(!1)}},ie=async a=>{var u;if(await((u=Q.value)==null?void 0:u.validate())){$.value=!0,a(!1);return}f(!0);try{await qe(w.value),Qe.success(n("user.success.grantQuota")),a(),k()}catch{}finally{f(!1)}},de=()=>{$.value=!1};return(a,o)=>{const u=Se,d=Re,p=Ge,D=He,h=Je,c=Ke,ce=je,R=We,me=Xe,q=Ye,G=Ze,H=ea,pe=aa,g=ta,J=Be,K=la,_e=oa,S=sa,fe=Te,ve=na,be=ua,he=Fe,ge=Ne,ye=ra,ke=ia,$e=da,we=ca,Ce=ma,Ve=pa,Ie=_a;return _(),y("div",va,[e(p,{class:"container-breadcrumb"},{default:t(()=>[e(d,null,{default:t(()=>[e(u)]),_:1}),e(d,null,{default:t(()=>[m(i(a.$t("menu.user")),1)]),_:1}),e(d,null,{default:t(()=>[m(i(a.$t("menu.user.list")),1)]),_:1})]),_:1}),e(Ie,{class:"general-card",title:a.$t("menu.user.list")},{extra:t(()=>[e(Ve,{visible:$.value,"onUpdate:visible":o[8]||(o[8]=l=>$.value=l),title:a.$t("user.form.title.grantQuota"),"ok-text":a.$t("user.button.save"),onCancel:de,onBeforeOk:ie},{default:t(()=>[e(G,{ref_key:"formRef",ref:Q,model:w.value},{default:t(()=>[e(h,{field:"quota",label:a.$t("user.label.quota"),rules:[{required:!0,message:a.$t("user.error.quota.required")}]},{default:t(()=>[e(Ce,{modelValue:w.value.quota,"onUpdate:modelValue":o[7]||(o[7]=l=>w.value.quota=l),placeholder:a.$t("user.placeholder.quota")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["visible","title","ok-text"])]),default:t(()=>[e(q,null,{default:t(()=>[e(c,{flex:1},{default:t(()=>[e(G,{model:s.value,"label-col-props":{span:6},"wrapper-col-props":{span:18},"label-align":"left"},{default:t(()=>[e(q,{gutter:16},{default:t(()=>[e(c,{span:8},{default:t(()=>[e(h,{field:"user_id",label:a.$t("user.form.userId")},{default:t(()=>[e(D,{modelValue:s.value.user_id,"onUpdate:modelValue":o[0]||(o[0]=l=>s.value.user_id=l),placeholder:a.$t("user.form.userId.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:t(()=>[e(h,{field:"name",label:a.$t("user.form.name")},{default:t(()=>[e(D,{modelValue:s.value.name,"onUpdate:modelValue":o[1]||(o[1]=l=>s.value.name=l),placeholder:a.$t("user.form.name.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:t(()=>[e(h,{field:"models",label:a.$t("user.form.models")},{default:t(()=>[e(R,{modelValue:s.value.models,"onUpdate:modelValue":o[2]||(o[2]=l=>s.value.models=l),placeholder:a.$t("user.form.selectDefault"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:t(()=>[(_(!0),y(N,null,L(E.value,l=>(_(),W(ce,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:t(()=>[e(h,{field:"key",label:a.$t("user.form.key")},{default:t(()=>[e(D,{modelValue:s.value.key,"onUpdate:modelValue":o[3]||(o[3]=l=>s.value.key=l),placeholder:a.$t("user.form.key.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:t(()=>[e(h,{field:"status",label:a.$t("user.form.status")},{default:t(()=>[e(R,{modelValue:s.value.status,"onUpdate:modelValue":o[4]||(o[4]=l=>s.value.status=l),options:M(te),placeholder:a.$t("user.form.selectDefault"),"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:t(()=>[e(h,{field:"created_at",label:a.$t("user.form.created_at")},{default:t(()=>[e(me,{modelValue:s.value.created_at,"onUpdate:modelValue":o[5]||(o[5]=l=>s.value.created_at=l),style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(H,{style:{height:"84px"},direction:"vertical"}),e(c,{flex:"86px",style:{"text-align":"right"}},{default:t(()=>[e(K,{direction:"vertical",size:18},{default:t(()=>[e(g,{type:"primary",onClick:O},{icon:t(()=>[e(pe)]),default:t(()=>[m(" "+i(a.$t("user.form.search")),1)]),_:1}),e(g,{onClick:oe},{icon:t(()=>[e(J)]),default:t(()=>[m(" "+i(a.$t("user.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(H,{style:{"margin-top":"0"}}),e(q,{style:{"margin-bottom":"16px"}},{default:t(()=>[e(c,{span:12},{default:t(()=>[e(K,null,{default:t(()=>[e(g,{type:"primary",onClick:o[6]||(o[6]=l=>a.$router.push({name:"UserCreate"}))},{icon:t(()=>[e(_e)]),default:t(()=>[m(" "+i(a.$t("user.operation.create")),1)]),_:1})]),_:1})]),_:1}),e(c,{span:12,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:t(()=>[e(S,{content:a.$t("searchTable.actions.refresh")},{default:t(()=>[v("div",{class:"action-icon",onClick:O},[e(J,{size:"18"})])]),_:1},8,["content"]),e(be,{onSelect:se},{content:t(()=>[(_(!0),y(N,null,L(M(ee),l=>(_(),W(ve,{key:l.value,value:l.value,class:Oe({active:l.value===I.value})},{default:t(()=>[v("span",null,i(l.name),1)]),_:2},1032,["value","class"]))),128))]),default:t(()=>[e(S,{content:a.$t("searchTable.actions.density")},{default:t(()=>[v("div",ba,[e(fe,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(S,{content:a.$t("searchTable.actions.columnSetting")},{default:t(()=>[e(ke,{trigger:"click",position:"bl",onPopupVisibleChange:ue},{content:t(()=>[v("div",ga,[(_(!0),y(N,null,L(V.value,(l,C)=>(_(),y("div",{key:l.dataIndex,class:"setting"},[v("div",ya,[e(ge)]),v("div",null,[e(ye,{modelValue:l.checked,"onUpdate:modelValue":B=>l.checked=B,onChange:B=>ne(B,l,C)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),v("div",ka,i(l.title==="#"?"\u5E8F\u5217\u53F7":l.title),1)]))),128))])]),default:t(()=>[v("div",ha,[e(he,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(we,{"row-key":"id",loading:M(Z),pagination:z,columns:b.value,data:x.value,bordered:!1,size:I.value,"row-selection":X,onPageChange:le},{status:t(({record:l})=>[l.status===3?(_(),y("span",$a)):(_(),y("span",wa)),m(" "+i(a.$t(`user.dict.status.${l.status}`)),1)]),operations:t(({record:l})=>[e(g,{type:"text",size:"small",onClick:C=>re({user_id:`${l.user_id}`})},{default:t(()=>[m(i(a.$t("user.columns.operations.grantQuota")),1)]),_:2},1032,["onClick"]),e(g,{type:"text",size:"small",onClick:C=>a.$router.push({name:"UserDetail",query:{id:`${l.id}`}})},{default:t(()=>[m(i(a.$t("user.columns.operations.view")),1)]),_:2},1032,["onClick"]),e(g,{type:"text",size:"small",onClick:C=>a.$router.push({name:"UserUpdate",query:{id:`${l.id}`}})},{default:t(()=>[m(i(a.$t("user.columns.operations.update")),1)]),_:2},1032,["onClick"]),e($e,{content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?",onOk:C=>Y({id:`${l.id}`})},{default:t(()=>[e(g,{type:"text",size:"small"},{default:t(()=>[m(i(a.$t("user.columns.operations.delete")),1)]),_:1})]),_:2},1032,["onOk"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"])]),_:1},8,["title"])])}}});const Ka=Le(Va,[["__scopeId","data-v-e92a165d"]]);export{Ka as default};
