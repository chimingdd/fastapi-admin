import{u as we,t as $e,m as ke,v as Ce,I as Ve,w as Ie,_ as ze}from"./index.118dd0ea.js";import{u as Se}from"./loading.b0aa7954.js";/* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css                */import{c as B,S as De}from"./sortable.esm.16d09f12.js";/* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css              */import{d as Ae,r as H,e as _,c as T,w as Me,B as g,C as b,aH as e,aG as a,aL as i,aM as s,aJ as L,aI as N,aD as R,u as F,F as v,D as Be,n as Te,aK as Le,aF as Ne,b2 as Fe,b3 as Pe,bB as Ue,bC as qe,bD as xe,bE as Ee,bF as Ke,b6 as Oe,bG as je,ab as He,aV as Re,bj as Ge,a5 as Je,bk as Qe,bm as We,bn as Xe,b5 as Ye,bH as Ze,bI as et,bJ as tt,bK as at}from"./arco.a11b8b88.js";import{s as lt,q as ot,a as nt}from"./agent.26522976.js";import{q as st}from"./model.8ec249e7.js";import"./chart.87d6227d.js";import"./vue.e9a5701d.js";const dt={class:"container"},it={class:"action-icon"},ut={class:"action-icon"},ct={id:"tableSetting"},rt={style:{"margin-right":"4px",cursor:"move"}},mt={class:"title"},pt={key:0,class:"circle red"},_t={key:1,class:"circle"},gt={name:"ModelAgentList"},ft=Ae({...gt,setup(vt){const G=H({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),P=_([]);(async()=>{try{const{data:t}=await st();P.value=t.items}catch{}})();const J=async t=>{y(!0);try{await lt(t),I()}catch{}finally{y(!1)}},U=()=>({app_id:_(),name:"",models:[],key:"",type:_(),status:_(),created_at:[]}),{loading:Q,setLoading:y}=Se(!0),{t:d}=we(),q=_([]),n=_(U()),h=_([]),$=_([]),z=_("medium"),k={current:1,pageSize:10,showTotal:!0,showPageSize:!0},C=H({...k}),W=T(()=>[{name:d("searchTable.size.mini"),value:"mini"},{name:d("searchTable.size.small"),value:"small"},{name:d("searchTable.size.medium"),value:"medium"},{name:d("searchTable.size.large"),value:"large"}]),X=T(()=>[{title:d("model.agent.columns.name"),dataIndex:"name",slotName:"name",align:"center",width:200},{title:d("model.agent.columns.baseUrl"),dataIndex:"base_url",slotName:"base_url",align:"center",width:200},{title:d("model.agent.columns.models"),dataIndex:"model_names",slotName:"model_names",align:"center",ellipsis:!0,tooltip:!0},{title:d("model.agent.columns.weight"),dataIndex:"weight",slotName:"weight",align:"center",width:80},{title:d("model.agent.columns.status"),dataIndex:"status",slotName:"status",align:"center",width:80},{title:d("model.agent.columns.updated_at"),dataIndex:"updated_at",slotName:"updated_at",align:"center",width:170},{title:d("model.agent.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:290}]),Y=T(()=>[{label:d("model.agent.dict.status.1"),value:1},{label:d("model.agent.dict.status.2"),value:2}]),V=async(t={current:1,pageSize:10})=>{y(!0);try{const{data:o}=await ot(t);q.value=o.items,C.current=t.current,C.pageSize=t.pageSize,C.total=o.paging.total}catch{}finally{y(!1)}},I=()=>{V({...k,...n.value})},Z=t=>{V({...k,...n.value,current:t})},ee=t=>{V({...k,...n.value,pageSize:t})};V();const te=()=>{n.value=U()},ae=async t=>{y(!0);try{t.status=t.status===1?2:1,await nt(t),I()}catch{}finally{y(!1)}},le=(t,o)=>{z.value=t},oe=(t,o,r)=>{t?h.value.splice(r,0,o):h.value=$.value.filter(u=>u.dataIndex!==o.dataIndex)},x=(t,o,r,u=!1)=>{const m=u?B(t):t;return o>-1&&r>-1&&m.splice(o,1,m.splice(r,1,m[o]).pop()),m},ne=t=>{t&&Te(()=>{const o=document.getElementById("tableSetting");new De(o,{onEnd(r){const{oldIndex:u,newIndex:m}=r;x(h.value,u,m),x($.value,u,m)}})})};return Me(()=>X.value,t=>{h.value=B(t),h.value.forEach((o,r)=>{o.checked=!0}),$.value=B(h.value)},{deep:!0,immediate:!0}),(t,o)=>{const r=$e,u=Le,m=Ne,S=Fe,w=Pe,c=Ue,se=qe,E=xe,de=Ee,D=Ke,ie=Oe,K=je,ue=He,f=Re,O=ke,j=Ge,ce=Je,A=Qe,re=Ce,me=We,pe=Xe,_e=Ve,ge=Ie,fe=Ye,ve=Ze,he=et,be=tt,ye=at;return g(),b("div",dt,[e(m,{class:"container-breadcrumb"},{default:a(()=>[e(u,null,{default:a(()=>[e(r)]),_:1}),e(u,null,{default:a(()=>[i(s(t.$t("menu.agent")),1)]),_:1}),e(u,null,{default:a(()=>[i(s(t.$t("menu.model.agent.list")),1)]),_:1})]),_:1}),e(ye,{class:"general-card",title:t.$t("menu.model.agent.list"),bordered:!1},{default:a(()=>[e(D,null,{default:a(()=>[e(c,{flex:1},{default:a(()=>[e(ie,{model:n.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(D,{gutter:16},{default:a(()=>[e(c,{span:8},{default:a(()=>[e(w,{field:"app_id",label:t.$t("model.agent.form.appId")},{default:a(()=>[e(S,{modelValue:n.value.app_id,"onUpdate:modelValue":o[0]||(o[0]=l=>n.value.app_id=l),placeholder:t.$t("model.agent.form.appId.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"name",label:t.$t("model.agent.form.name")},{default:a(()=>[e(S,{modelValue:n.value.name,"onUpdate:modelValue":o[1]||(o[1]=l=>n.value.name=l),placeholder:t.$t("model.agent.form.name.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"models",label:t.$t("model.agent.form.models")},{default:a(()=>[e(E,{modelValue:n.value.models,"onUpdate:modelValue":o[2]||(o[2]=l=>n.value.models=l),placeholder:t.$t("model.agent.form.selectDefault"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:a(()=>[(g(!0),b(L,null,N(P.value,l=>(g(),R(se,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"key",label:t.$t("model.agent.form.key")},{default:a(()=>[e(S,{modelValue:n.value.key,"onUpdate:modelValue":o[3]||(o[3]=l=>n.value.key=l),placeholder:t.$t("model.agent.form.key.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"status",label:t.$t("model.agent.form.status")},{default:a(()=>[e(E,{modelValue:n.value.status,"onUpdate:modelValue":o[4]||(o[4]=l=>n.value.status=l),options:F(Y),placeholder:t.$t("model.agent.form.selectDefault"),"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"created_at",label:t.$t("model.agent.form.created_at")},{default:a(()=>[e(de,{modelValue:n.value.created_at,"onUpdate:modelValue":o[5]||(o[5]=l=>n.value.created_at=l),style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(K,{style:{height:"84px"},direction:"vertical"}),e(c,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(j,{direction:"vertical",size:18},{default:a(()=>[e(f,{type:"primary",onClick:I},{icon:a(()=>[e(ue)]),default:a(()=>[i(" "+s(t.$t("model.agent.form.search")),1)]),_:1}),e(f,{onClick:te},{icon:a(()=>[e(O)]),default:a(()=>[i(" "+s(t.$t("model.agent.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(K,{style:{"margin-top":"0"}}),e(D,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(c,{span:12},{default:a(()=>[e(j,null,{default:a(()=>[e(f,{type:"primary",onClick:o[6]||(o[6]=l=>t.$router.push({name:"ModelAgentCreate"}))},{icon:a(()=>[e(ce)]),default:a(()=>[i(" "+s(t.$t("model.agent.operation.create")),1)]),_:1})]),_:1})]),_:1}),e(c,{span:12,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:a(()=>[e(A,{content:t.$t("searchTable.actions.refresh")},{default:a(()=>[v("div",{class:"action-icon",onClick:I},[e(O,{size:"18"})])]),_:1},8,["content"]),e(pe,{onSelect:le},{content:a(()=>[(g(!0),b(L,null,N(F(W),l=>(g(),R(me,{key:l.value,value:l.value,class:Be({active:l.value===z.value})},{default:a(()=>[v("span",null,s(l.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(A,{content:t.$t("searchTable.actions.density")},{default:a(()=>[v("div",it,[e(re,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(A,{content:t.$t("searchTable.actions.columnSetting")},{default:a(()=>[e(ve,{trigger:"click",position:"bl",onPopupVisibleChange:ne},{content:a(()=>[v("div",ct,[(g(!0),b(L,null,N($.value,(l,p)=>(g(),b("div",{key:l.dataIndex,class:"setting"},[v("div",rt,[e(ge)]),v("div",null,[e(fe,{modelValue:l.checked,"onUpdate:modelValue":M=>l.checked=M,onChange:M=>oe(M,l,p)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),v("div",mt,s(l.title==="#"?"\u5E8F\u5217\u53F7":l.title),1)]))),128))])]),default:a(()=>[v("div",ut,[e(_e,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(be,{"row-key":"id",loading:F(Q),pagination:C,columns:h.value,data:q.value,bordered:!1,size:z.value,"row-selection":G,onPageChange:Z,onPageSizeChange:ee},{model_names:a(({record:l})=>{var p;return[i(s(((p=l==null?void 0:l.model_names)==null?void 0:p.join(","))||"-"),1)]}),weight:a(({record:l})=>[i(s(l.weight||"-"),1)]),status:a(({record:l})=>[l.status===2?(g(),b("span",pt)):(g(),b("span",_t)),i(" "+s(t.$t(`app.dict.status.${l.status}`)),1)]),operations:a(({record:l})=>[e(f,{type:"text",size:"small",onClick:p=>t.$router.push({name:"ModelAgentDetail",query:{id:`${l.id}`}})},{default:a(()=>[i(s(t.$t("model.agent.columns.operations.view")),1)]),_:2},1032,["onClick"]),e(f,{type:"text",size:"small",onClick:p=>t.$router.push({name:"ModelAgentUpdate",query:{id:`${l.id}`}})},{default:a(()=>[i(s(t.$t("model.agent.columns.operations.update")),1)]),_:2},1032,["onClick"]),e(f,{type:"text",size:"small",onClick:p=>t.$router.push({name:"KeyModelList",query:{agent_id:`${l.id}`}})},{default:a(()=>[i(s(t.$t("model.agent.columns.operations.manageKey")),1)]),_:2},1032,["onClick"]),e(f,{type:"text",size:"small",onClick:p=>ae({id:`${l.id}`,status:Number(`${l.status}`)})},{default:a(()=>[i(s(t.$t(`key.columns.operations.status.${l.status}`)),1)]),_:2},1032,["onClick"]),e(he,{content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?",onOk:p=>J({id:`${l.id}`})},{default:a(()=>[e(f,{type:"text",size:"small"},{default:a(()=>[i(s(t.$t("model.agent.columns.operations.delete")),1)]),_:1})]),_:2},1032,["onOk"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"])]),_:1},8,["title"])])}}});const Et=ze(ft,[["__scopeId","data-v-c4bc2a33"]]);export{Et as default};
